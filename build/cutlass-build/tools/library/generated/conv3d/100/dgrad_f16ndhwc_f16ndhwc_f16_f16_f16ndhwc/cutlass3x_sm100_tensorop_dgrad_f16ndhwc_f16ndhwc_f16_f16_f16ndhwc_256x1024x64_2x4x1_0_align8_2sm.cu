
/*
  Generated by conv3d_operation.py - Do not edit.
*/

///////////////////////////////////////////////////////////////////////////////////////////////////

#include "cutlass/cutlass.h"
#include "cutlass/library/library.h"
#include "cutlass/library/manifest.h"

#include "library_internal.h"
#include "conv_operation_3x.hpp"
#include "cutlass/conv/device/conv_universal_adapter.hpp"
#include "cutlass/conv/kernel/conv_universal.hpp"
#include "cutlass/conv/collective/collective_builder.hpp"
#include "cutlass/epilogue/collective/collective_builder.hpp"

///////////////////////////////////////////////////////////////////////////////////////////////////



// CUTLASS >= 3 convolution Dgrad kernel instance "cutlass3x_sm100_tensorop_dgrad_f16ndhwc_f16ndhwc_f16_f16_f16ndhwc_256x1024x64_2x4x1_0_align8_2sm"
using cutlass3x_sm100_tensorop_dgrad_f16ndhwc_f16ndhwc_f16_f16_f16ndhwc_256x1024x64_2x4x1_0_align8_2sm_epilogue =
  typename cutlass::epilogue::collective::CollectiveBuilder<
    cutlass::arch::Sm100,
    cutlass::arch::OpClassTensorOp,
    cute::Shape<cute::_256, cute::_256, cute::Shape<cute::_64>>,               // mma tile shape
    cute::Shape<cute::_2, cute::_4, cute::_1>,                // cluster shape
    cutlass::epilogue::collective::EpilogueTileAuto,
    cutlass::half_t,
    cutlass::half_t,
    cutlass::half_t, cutlass::layout::TensorNDHWC, 128 / cute::sizeof_bits_v<cutlass::half_t>,
    cutlass::half_t, cutlass::layout::TensorNDHWC, 128 / cute::sizeof_bits_v<cutlass::half_t>,
    cutlass::epilogue::collective::EpilogueScheduleAuto
    // , class FusionOpOrCallbacks = cutlass::epilogue::fusion::LinearCombination<ElementD,ElementCompute>
  >::CollectiveOp;

using cutlass3x_sm100_tensorop_dgrad_f16ndhwc_f16ndhwc_f16_f16_f16ndhwc_256x1024x64_2x4x1_0_align8_2sm_mainloop =
  typename cutlass::conv::collective::CollectiveBuilder<
    cutlass::arch::Sm100,
    cutlass::arch::OpClassTensorOp,
    cutlass::conv::Operator::kDgrad,         // kFprop, kDgrad, or kWgrad
    cutlass::half_t, cutlass::layout::TensorNDHWC, 128 / cute::sizeof_bits_v<cutlass::half_t>,
    cutlass::half_t, cutlass::layout::TensorNDHWC, 128 / cute::sizeof_bits_v<cutlass::half_t>,
    cutlass::half_t,
    cute::Shape<cute::_256, cute::_256, cute::Shape<cute::_64>>,        // mma tile shape
    cute::Shape<cute::_2, cute::_4, cute::_1>,         // cluster shape
    cutlass::conv::collective::StageCountAutoCarveout<sizeof(typename cutlass3x_sm100_tensorop_dgrad_f16ndhwc_f16ndhwc_f16_f16_f16ndhwc_256x1024x64_2x4x1_0_align8_2sm_epilogue::SharedStorage)>,
    cutlass::conv::KernelImplicitTmaWarpSpecialized2SmSm100
  >::CollectiveOp;

using cutlass3x_sm100_tensorop_dgrad_f16ndhwc_f16ndhwc_f16_f16_f16ndhwc_256x1024x64_2x4x1_0_align8_2sm_problem_shape = cutlass::conv::ConvProblemShape<cutlass::conv::Operator::kDgrad, cutlass3x_sm100_tensorop_dgrad_f16ndhwc_f16ndhwc_f16_f16_f16ndhwc_256x1024x64_2x4x1_0_align8_2sm_mainloop::NumSpatialDimensions>;

// Unit tests call this "ConvKernel".
// Conv operator cutlass3x_sm100_tensorop_dgrad_f16ndhwc_f16ndhwc_f16_f16_f16ndhwc_256x1024x64_2x4x1_0_align8_2sm
using cutlass3x_sm100_tensorop_dgrad_f16ndhwc_f16ndhwc_f16_f16_f16ndhwc_256x1024x64_2x4x1_0_align8_2sm_base = cutlass::conv::kernel::ConvUniversal<
    cutlass3x_sm100_tensorop_dgrad_f16ndhwc_f16ndhwc_f16_f16_f16ndhwc_256x1024x64_2x4x1_0_align8_2sm_problem_shape,
    cutlass3x_sm100_tensorop_dgrad_f16ndhwc_f16ndhwc_f16_f16_f16ndhwc_256x1024x64_2x4x1_0_align8_2sm_mainloop,
    cutlass3x_sm100_tensorop_dgrad_f16ndhwc_f16ndhwc_f16_f16_f16ndhwc_256x1024x64_2x4x1_0_align8_2sm_epilogue,
    void
  >;

// Derived class
struct cutlass3x_sm100_tensorop_dgrad_f16ndhwc_f16ndhwc_f16_f16_f16ndhwc_256x1024x64_2x4x1_0_align8_2sm :
  public cutlass3x_sm100_tensorop_dgrad_f16ndhwc_f16ndhwc_f16_f16_f16ndhwc_256x1024x64_2x4x1_0_align8_2sm_base { };

///////////////////////////////////////////////////////////////////////////////////////////////////



namespace cutlass {
namespace library {

// Initialize all instances
void initialize_cutlass3x_sm100_tensorop_dgrad_f16ndhwc_f16ndhwc_f16_f16_f16ndhwc_256x1024x64_2x4x1_0_align8_2sm(Manifest &manifest) {

  using Operation_cutlass3x_sm100_tensorop_dgrad_f16ndhwc_f16ndhwc_f16_f16_f16ndhwc_256x1024x64_2x4x1_0_align8_2sm = cutlass::conv::device::ConvUniversalAdapter<
    cutlass3x_sm100_tensorop_dgrad_f16ndhwc_f16ndhwc_f16_f16_f16ndhwc_256x1024x64_2x4x1_0_align8_2sm>;

  manifest.append(new cutlass::library::ConvOperation3x<
      Operation_cutlass3x_sm100_tensorop_dgrad_f16ndhwc_f16ndhwc_f16_f16_f16ndhwc_256x1024x64_2x4x1_0_align8_2sm
    >(
      "cutlass3x_sm100_tensorop_dgrad_f16ndhwc_f16ndhwc_f16_f16_f16ndhwc_256x1024x64_2x4x1_0_align8_2sm"
    ));

}


///////////////////////////////////////////////////////////////////////////////////////////////////

} // namespace library
} // namespace cutlass

///////////////////////////////////////////////////////////////////////////////////////////////////

